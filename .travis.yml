sudo: required
dist: trusty
language: python
python:
  - "2.7"
virtualenv:
  system_site_packages: true
before_install:
  - sudo apt-get install -y --force-yes python-pip python2.7-dev libxext-dev python-qt4 pyqt4-dev-tools build-essential
#  - ln -s /usr/lib/python2.7/dist-packages/PyQt4/ ~/virtualenv/python2.7.10/lib/python2.7/site-packages/
#  - ln -s /usr/lib/python2.7/dist-packages/sip.so ~/virtualenv/python2.7.10/lib/python2.7/site-packages/
#Install PyQt4 and sip
  - sudo mkdir -p /downloads
  - sudo chmod a+rw /downloads
  - curl -L http://sourceforge.net/projects/pyqt/files/sip/sip-4.16.5/sip-4.16.5.tar.gz -o /downloads/sip.tar.gz 
  - curl -L http://sourceforge.net/projects/pyqt/files/PyQt4/PyQt-4.11.3/PyQt-x11-gpl-4.11.3.tar.gz -o /downloads/pyqt4.tar.gz
  - sudo mkdir -p /builds
  - sudo chmod a+rw /builds
  - pushd /builds
  # SIP
  - tar xzf /downloads/sip.tar.gz --keep-newer-files
  - pushd sip-4.16.5
  - python configure.py
  - make
  - sudo make install
  - popd
  # PyQt4
  - tar xzf /downloads/pyqt4.tar.gz --keep-newer-files
  - pushd PyQt-x11-gpl-4.11.3
  - python configure.py -c --confirm-license --no-designer-plugin -e QtCore -e QtGui
  - make
  - sudo make install
  - popd
  - popd
#Finished installation
  - sudo add-apt-repository http://www.openfoam.org/download/ubuntu
  - sudo apt-get -qq update
  - sudo apt-get install -y --force-yes openfoam240
  - sudo apt-get install -y --force-yes paraviewopenfoam410
  - sudo apt-get install -y --force-yes libfreetype6-dev libpng12-dev
  - pip install -r requirements.txt
  - ./install_external.sh
  - . /opt/openfoam240/etc/bashrc
  - source /opt/openfoam240/etc/bashrc
install:
  - python setup.py install
script:
  - petroSym
#after_success:
#  - petroSym
